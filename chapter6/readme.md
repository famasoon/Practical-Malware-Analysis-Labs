# Chapter 6 Labs
## Lab 6-1
1. I found a branch. 
I think the if statement is included in this subroutine.
2. It is function that only takes an argment and calls "sub_401282".
3. The purpose of this program is to check the Internet connection.

## Lab 6-2
1. That is checking whether the Internet connection is normal.
2. This subroutine is a wrapper around other function.
3. The function "sub_401040" reads an command from the C2 server.
4. If and Switch statements were used.
5. I found the string "http://www.practicalmalwareanalysis.com/cc.htm".
I think that this URL is belongs to the C2 server.
I also found the string "Internet Explorer 7.5 / pma".
This is the User Agent to connect to the C2 server.
6. The purpose of this malware is to excute the command sent from the C2 server.

## Lab 6-3
1. This program added new function that "sub_401130".
2. It takes a string and a byte value as parameters.
3. This function contain a switch statement that uses a jump table.
4. Create directories, copy and delete malware, register malware with startup program, and wait.
5. This program contains the registry name "Software\\Microsoft\\Windows\\CurrentVersion\\Run".
I guess that by registering malware here it is about to launch malware at startup.
6. One of the aims of this malware is to excute instructions from the C2 server.
Another purpose is to make malware deeply intrude into the system.

## Lab 6-4
1. The lab 6-4 can execute commands many times as compared with 6-3.
2. It added loop structure compared with 6-3.
Therefore, this malware can excute commands at any time during looping.
3. It has string  "Internet Explorer 7.50/pma%d".
I think this string is used in User-Agent.
4. It will run for 1440 minutes.
5. Yes, it is a new User-Agent.
"%d" of this User-Agent is excution time.
6. The purpose of this malware is command execution.
Continue this for 1440 minutes.