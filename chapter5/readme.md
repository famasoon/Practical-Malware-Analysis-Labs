# Chapter 5 Labs
## Lab 5-1
1. 0x1000D02E
2. 0x100163CC
3. Five functions call gethostbyname.
4. Yes, this requests value "pics.praticalmalwareanalys.com".
5. IDA Pro recognized 23 local variables.
6. IDA pro recognized only one parametor.
7. 0x10095B34
8. The received command is excuting with "cmd.exe".
This often called "reverse shell".
9. Determine the value to set according to the version of Windows.
The value set to 0x100101C8 is the return value of "sub_10003695".
"sub_10003695" calls "GetVersionExA" and the return value changed according to this result.
10. It gets working time from the registry "SOFTWARE\Microsoft\Windows\CurrentVersion".
11. Enumerate process.
12. This function calls "GetSystemDefaultLangID", "strlen" and "sprintf" to get the Language ID.
So I name this function "GetLanguage".
13. DllMain called 4 API functions directly.
I could not make the depth "2"... :(
14. 30 * 1000(0x3E8) = 30.
So this program will sleep 30 seconds.
15. There are address family, socket type and protocol.
16. After using MSDN, I changed them "AF_INET", "SOCK_STREAM" and "IPPROTO_TCP".
17. I did not find "in" instruction.
18. I pressed "ctrl + g" and typed "0x1001D988".
It's like ASCII character here.
19. I did not work idapython.
I will do it this time.
20. That choose Edit  > Strings > ASCII.
21. Read 0x50 bytes of data from the cursor and rewrite it to XOR 0x55.